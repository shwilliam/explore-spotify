(function(e){function t(t){for(var r,c,a=t[0],s=t[1],l=t[2],d=0,f=[];d<a.length;d++)c=a[d],o[c]&&f.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),o=n.n(r);o.a},"4d7f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("ExploreView",{attrs:{token:e.accessToken}})],1)},i=[],c=(n("386d"),n("72bf")),a=n.n(c),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"explore-graph"},[e.loading?n("span",[e._v("loading...")]):n("div",[n("Graph",{key:e.updateTrigger,attrs:{nodes:e.recommendations,links:e.links,force:e.force,width:"300",height:"300"},on:{click:e.handleNodeClick}})],1),e.errored?n("span",[e._v("please refresh to try again")]):e._e()])},l=[],u=n("0a4a"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticClass:"graph",attrs:{width:e.width,height:e.height},on:{click:e.handleClick}},[n("g",{attrs:{transform:"translate("+e.width/2+", "+e.height/2+")"}},[n("g",{staticClass:"links"},e._l(e.links,function(t){return n("line",{key:"link-"+e.links.indexOf(t),staticClass:"link",attrs:{stroke:"black",x1:t.source.x,y1:t.source.y,x2:t.target.x,y2:t.target.y}})})),n("g",{staticClass:"nodes"},e._l(e.nodes,function(t){return n("g",{key:"node-"+e.nodes.indexOf(t),staticClass:"node",attrs:{transform:"translate("+(t.x||0)+", "+(t.y||0)+")"}},[n("text",[e._v(e._s(t.name))]),n("circle",{key:"circle-"+t.id,staticClass:"node",attrs:{id:t.id,r:"8",fill:"crimson"}})])}))])])},f=[],h={name:"graph",props:["nodes","links","width","height"],methods:{handleClick:function(e){"circle"===e.target.tagName&&this.$emit("click",e.target.id)}}},p=h,g=(n("b0ca"),n("2877")),k=Object(g["a"])(p,d,f,!1,null,"200ed8c5",null);k.options.__file="Graph.vue";var m=k.exports,v="https://api.spotify.com/v1",b={name:"explore-graph",props:["token"],components:{Graph:m},data:function(){return{recommendations:[],links:[],clickedTracks:[],errored:null,loading:!0,updateTrigger:0}},computed:{force:function(){return Object(u["d"])(this.recommendations).force("charge",Object(u["c"])().strength(-100)).force("forceX",Object(u["e"])().strength(.2)).force("forceY",Object(u["f"])().strength(.1)).force("center",Object(u["a"])()).force("link",Object(u["b"])().links(this.links)).on("tick",this.rerender)}},created:function(){var e=this;this.fetchRecommendedTracks().then(function(e){return e.json()}).then(function(t){var n=t.tracks,r=[],o=[{id:""}];return n.map(function(e){o.push(e),r.push({source:0,target:o.indexOf(e)})}),e.links=r,e.recommendations=o,{recommendations:o,links:r}}).catch(function(t){return e.errored=!0,console.error(t)}).finally(function(){e.loading=!1})},methods:{fetchRecommendedTracks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2wq3IABSPtBFush3qsfZoK";return fetch("".concat(v,"/recommendations?limit=").concat(e,"&seed_tracks=").concat(t),{headers:{Authorization:"Bearer ".concat(this.token)}})},handleNodeClick:function(e){var t=this;this.loading=!0;var n=this.recommendations.filter(function(t){return t.id===e})[0].index;this.clickedTracks.push(e);var r=this.clickedTracks.join(",");this.fetchRecommendedTracks(10,r).then(function(e){return e.json()}).then(function(e){var r=e.tracks,o=t.recommendations.length;r.map(function(e){t.recommendations.push(e),t.links.push({source:n,target:r.indexOf(e)+o})})}).catch(function(e){return t.errored=!0,console.error(e)}).finally(function(){t.loading=!1})},rerender:function(){this.updateTrigger+=1}}},y=b,_=Object(g["a"])(y,s,l,!1,null,null,null);_.options.__file="ExploreView.vue";var x=_.exports,w={name:"app",data:function(){return{accessToken:void 0}},components:{ExploreView:x},created:function(){this.accessToken=a.a.parse(window.location.search).access_token,this.accessToken||(window.location.href="https://explore-spotify-login.herokuapp.com/login")}},O=w,j=(n("034f"),Object(g["a"])(O,o,i,!1,null,null,null));j.options.__file="App.vue";var T=j.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(T)}}).$mount("#app")},"64a9":function(e,t,n){},b0ca:function(e,t,n){"use strict";var r=n("4d7f"),o=n.n(r);o.a}});
//# sourceMappingURL=app.b7240372.js.map